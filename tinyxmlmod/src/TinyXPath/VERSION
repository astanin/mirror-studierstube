This code is based on TinyXPath Version 1.2.3